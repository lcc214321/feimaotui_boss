!function (a) {
    var t, e = {
        content: "",
        close: !0,
        monitor: "body",
        iframe: !0,
        iframeHeight: function () {
            return a(".content-wrapper").height() - 42
        },
        target: ".nav-tabs",
        contextmenu: !0,
        local: {
          /*  refreshLabel: "刷新此标签",
            closeThisLabel: "关闭此标签",
            closeOtherLabel: "关闭其他标签",
            closeLeftLabel: "关闭左侧标签",
            closeRightLabel: "关闭右侧标签"*/
            refreshLabel: "Refresh this label",
            closeThisLabel: "Close this label",
            closeOtherLabel: "Close other labels",
            closeLeftLabel: "Close the left label",
            closeRightLabel: "Close the right label"
        },
        callback: function () {
        }
    };
    _click = function (r) {
        var i;
        i = "object" == typeof r.data("addtab") ? r.data("addtab") : r.data(), i.id || i.addtab || (i.id = Math.random().toString(36).substring(3, 35), r.data("id", i.id)), a.addtabs.add({
            target: i.target ? i.target : t,
            id: i.id ? i.id : i.addtab,
            title: i.title ? i.title : r.html(),
            content: e.content ? e.content : i.content,
            url: i.url,
            refresh: !0,
            ajax: i.ajax ? !0 : !1
        })
    }, _createMenu = function (t, e, r) {
        return a("<a>", {
            href: "javascript:void(0);",
            "class": "list-group-item",
            "data-right": t
        }).append(a("<i>", {"class": "glyphicon " + e})).append(r)
    }, _pop = function (r, i, n) {
        a("body").find("#popMenu").remove();
        var d = i.attr("id") ? _createMenu("refresh", "glyphicon-refresh", e.local.refreshLabel) : "", o = i.attr("id") ? _createMenu("remove", "glyphicon-remove", e.local.closeThisLabel) : "", s = i.prev("li").attr("id") ? _createMenu("remove-left", "glyphicon-chevron-left", e.local.closeLeftLabel) : "", l = i.next("li").attr("id") ? _createMenu("remove-right", "glyphicon-chevron-right", e.local.closeRightLabel) : "", c = a("<ul>", {
            "aria-controls": r,
            "class": "rightMenu list-group",
            id: "popMenu",
            "aria-url": i.attr("aria-url"),
            "aria-ajax": i.attr("aria-ajax")
        }).append(d).append(o).append(_createMenu("remove-circle", "glyphicon-remove-circle", e.local.closeOtherLabel)).append(s).append(l);
        c.css({
            top: n.pageY,
            left: n.pageX
        }), c.appendTo(a("body")).fadeIn("fast"), a("ul.rightMenu a[data-right=refresh]").on("click", function () {
            var t = a(this).parent("ul").attr("aria-controls"), e = a(this).parent("ul").attr("aria-url"), r = a(this).parent("ul").attr("aria-ajax");
            a.addtabs.add({id: t, url: e, refresh: !0, ajax: r})
        }), a("ul.rightMenu a[data-right=remove]").on("click", function () {
            var t = a(this).parent("ul").attr("aria-controls");
            a.addtabs.close({id: t}), a.addtabs.drop()
        }), a("ul.rightMenu a[data-right=remove-circle]").on("click", function () {
            var e = a(this).parent("ul").attr("aria-controls");
            t.find("li").each(function () {
                var t = a(this).attr("id");
                t && t != "tab_" + e && a.addtabs.close({id: a(this).children("a").attr("aria-controls")})
            }), a.addtabs.drop()
        }), a("ul.rightMenu a[data-right=remove-left]").on("click", function () {
            var t = a(this).parent("ul").attr("aria-controls");
            a("#tab_" + t).prevUntil().each(function () {
                var e = a(this).attr("id");
                e && e != "tab_" + t && a.addtabs.close({id: a(this).children("a").attr("aria-controls")})
            }), a.addtabs.drop()
        }), a("ul.rightMenu a[data-right=remove-right]").on("click", function () {
            var e, r = a(this).parent("ul").attr("aria-controls");
            e = t.find("#tab_" + r).length > 0 ? a("#tab_" + r) : t.find("a[href=#" + r + "]").parent("li"), e.nextUntil().each(function () {
                var t = a(this).attr("id");
                t && t != "tab_" + r && a.addtabs.close({id: a(this).children("a").attr("aria-controls")})
            }), a.addtabs.drop()
        }), c.mouseleave(function () {
            a(this).fadeOut("slow")
        }), a("body").click(function () {
            c.fadeOut("slow")
        })
    }, _listen = function () {
        a(e.monitor).on("click", "[data-addtab]", function () {
            _click(a(this)), a.addtabs.drop()
        }), a("body").on("click", ".close-tab", function () {
            var t = a(this).prev("a").attr("aria-controls");
            a.addtabs.close({id: t}), a.addtabs.drop()
        }), e.contextmenu && a("body").on("contextmenu", "li[role=presentation]", function (t) {
            var e = a(this).children("a").attr("aria-controls");
            return _pop(e, a(this), t), !1
        });
        var t;
        a("body").on("dragstart.h5s", ".nav-tabs li", function (e) {
            t = a(this)
        }).on("dragover.h5s dragenter.h5s drop.h5s", ".nav-tabs li", function (e) {
            t != a(this) && (a(".dragBack").removeClass("dragBack"), a(this).addClass("dragBack"), t.insertAfter(a(this)))
        }).on("dragend.h5s", ".nav-tabs li", function () {
            a(".dragBack").removeClass("dragBack")
        }), a(window).resize(function () {
            a.addtabs.drop()
        })
    }, a.addtabs = function (t) {
        a.addtabs.set(t), _listen()
    }, a.addtabs.set = function () {
        arguments[0] && ("object" == typeof arguments[0] ? e = a.extend(e, arguments[0] || {}) : e[arguments[0]] = arguments[1]), t = "object" == typeof e.target ? e.target : a("body").find(e.target).length > 0 ? a(e.target).first() : a("body").find(".nav-tabs").first()
    }, a.addtabs.add = function (r) {
        var i, n;
        r.id = r.id ? r.id : Math.random().toString(36).substring(3, 35), i = "object" == typeof r.target ? r.target : "string" == typeof r.target ? a("body").find(r.target) : t;
        var d = r.id, o = i, s = o.next(".tab-content");
        if (o.find('li[role = "presentation"].active').removeClass("active"), s.find('div[role = "tabpanel"].active').removeClass("active"), o.find("#tab_" + d).length < 1) {
            var l = layer.load(1, {shade: [.1, "#fff"]}), c = a("<li>", {
                role: "presentation",
                id: "tab_" + d,
                "aria-url": r.url,
                "aria-ajax": r.ajax ? !0 : !1,
                "class": "nav-tabs-header"
            }).append(a("<a>", {href: "#" + d, "aria-controls": d, role: "tab", "data-toggle": "tab"}).html(r.title));
            c.on("dblclick", function () {
                var a = s.find("#" + d).find(".iframeClass")[0];
                a && a.contentWindow.location.reload(!0)
            }), e.close && c.append(a("<i>", {"class": "close-tab glyphicon glyphicon-remove"}));
            var n = a("<div>", {"class": "tab-pane", id: d, role: "tabpanel", height: e.iframeHeight()});
            o.append(c), s.append(n)
        } else {
            if (!r.refresh) return a("#tab_" + d).addClass("active"), void a("#" + d).addClass("active");
            n = a("#" + d), n.html("")
        }
        r.content ? n.append(r.content) : 1 != e.iframe || "false" != r.ajax && r.ajax ? n.load(r.url) : n.append(a("<iframe>", {
            "class": "iframeClass",
            height: e.iframeHeight(),
            frameborder: "no",
            border: "0",
            src: r.url,
            seamless: "seamless",
            onload: function () {
                layer.close(l)
            }
        })), o.find("#tab_" + d).addClass("active"), s.find("#" + d).addClass("active"), a.addtabs.drop(), e.callback()
    }, a.addtabs.close = function (t) {
        a("#tab_" + t.id).hasClass("active") && (a("#tab_" + t.id).parents("li.tabdrop").length > 0 && !a("#tab_" + t.id).parents("li.tabdrop").hasClass("hide") ? a("#tab_" + t.id).parents(".nav-tabs").find("li").last().addClass("active") : a("#tab_" + t.id).prev("li").addClass("active"), a("#" + t.id).prev().addClass("active")), a("#tab_" + t.id).remove(), a("#" + t.id).remove(), a.addtabs.drop(), e.callback()
    }, a.addtabs.closeself = function () {
        var e = t.find("li.active").children("a:first").attr("aria-controls"), r = {id: e};
        a.addtabs.close(r)
    }, a.addtabs.closeTo = function (r) {
        var i = t.find("li.active").children("a:first").attr("aria-controls");
        if (a("#tab_" + r).length > 0) {
            a("#tab_" + i).remove(), a("#" + i).remove(), a.addtabs.drop(), e.callback();
            var n = a(a("#tab_" + r)).children("a").attr("aria-controls"), d = a(a("#tab_" + r)).attr("aria-url"), o = a(a("#tab_" + r)).attr("aria-ajax");
            a.addtabs.add({id: n, url: d, refresh: !0, ajax: o})
        } else a.addtabs.close({id: i})
    }, a.addtabs.closeAll = function (t) {
        "string" == typeof t && (t = a("body").find(t)), a.each(t.find("li[id]"), function () {
            var t = a(this).children("a").attr("aria-controls");
            a("#tab_" + t).remove(), a("#" + t).remove()
        }), t.find('li[role = "presentation"]').first().addClass("active");
        var e = t.find('li[role = "presentation"]').first().children("a").attr("aria-controls");
        a("#" + e).addClass("active"), a.addtabs.drop()
    }, a.addtabs.drop = function () {
        // 点击addtabs 时触发
        var t = a("<li>", {"class": "dropdown pull-right hide tabdrop tab-drop nav-tabs-header"}).append(a("<a>", {
            "class": "dropdown-toggle",
            "data-toggle": "dropdown",
            href: "#"
        }).append(a("<i>", {"class": "glyphicon glyphicon-align-justify"})).append(a("<b>", {"class": "caret"}))).append(a("<ul>", {"class": "dropdown-menu"}));
        a(".content-wrapper").find(".nav-tabs").each(function () {
            var e = a(this);
            e.find(".tabdrop").length < 1 ? t.prependTo(e) : t = e.find(".tabdrop"), e.parent().is(".tabs-below") && t.addClass("dropup");
            var r = 0;
            e.append(t.find("li")).find(">li").not(".tabdrop").each(function () {
                (this.offsetTop > 0 || e.width() - a(this).position().left - a(this).width() < 83) && (t.find("ul").prepend(a(this)), r++)
            }), r > 0 ? (t.removeClass("hide"), 1 == t.find(".active").length ? t.addClass("active") : t.removeClass("active")) : t.addClass("hide")
        })
    }, a.addtabs.refresh = function (r) {
        alert(r.url);
       /* $('#content-wrapper').load(r.url, function () {
        });*/
    }
}(jQuery), $(function () {
    $.addtabs()
});